<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title><%= title %></title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="login-container">
    <h1 class="title">Login</h1>

    <% if (expired) { %>
      <div class="message expired">⚠️ Your session has expired. Please login again.</div>
    <% } %>

    <% if (logout) { %>
      <div class="message logout">✅ You have been logged out successfully.</div>
    <% } %>

    <% if (reset) { %>
      <div class="message reset">🔑 Your password has been reset. Please log in with your new password.</div>
    <% } %>

    <% if (error) { %>
      <div class="message error">❌ <%= error %></div>
    <% } %>

    <form action="/users/login" method="POST" class="login-form">
      <div class="form-group">
        <label>Email</label>
        <input type="email" name="email" placeholder="Enter your email" required>
      </div>

      <div class="form-group">
        <label>Password</label>
        <input type="password" name="password" placeholder="Enter your password" required>
      </div>

      <p class="forgot-link"><a href="/password/forgot">Forgot Password?</a></p>

      <!-- 🧠 Cloudflare Turnstile Widget -->
      <div class="cf-turnstile" data-sitekey="<%= process.env.TURNSTILE_SITEKEY %>"></div>

      <button type="submit" class="btn">Login</button>
    </form>

    <!-- 🔗 Back to Home -->
    <p class="home-link">
      <a href="/">🏠 Back to Home</a>
    </p>

    <!-- 📝 Register Link -->
    <p class="register-link">
      Don't have an account? <a href="/users/register">Register here</a>
    </p>
  </div>

  <!-- ⚙️ Turnstile Script -->
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
</body>
</html>
